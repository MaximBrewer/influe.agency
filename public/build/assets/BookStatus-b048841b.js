import{u as j,r as p,W as D,j as s,a as e}from"./app-37294207.js";import{A as E}from"./ArrowDown-6b20f1a0.js";import{I as h}from"./InputError-668fb783.js";import{I as k}from"./InputLabel-c6911704.js";import{P as S}from"./PrimaryButton-113bb876.js";import{T as P}from"./TextInput-99c0a043.js";import{s as L}from"./statuses-52d2cf53.js";const $={data:[{code:"cash",title:"Наличными"},{code:"card",title:"Картой"},{code:"qr",title:"Kaspi QR"},{code:"balance",title:"C баланса"}]},K=f=>{const{book:r,auth:b}=f,g=`${b.user.role.name}.book.payment`,{setModal:d,priceFormat:m}=j(),[x,o]=p.useState(!1),{data:l,setData:u,post:w,patch:C,processing:B,errors:n,reset:F,transform:v}=D({method:null,sum:"",prepay:!1});v(t=>({...t,method:t.method?t.method.code:null}));const y=t=>{t&&t.preventDefault(),w(route(g,{book:r.id}),{onSuccess:()=>{d(null)}})},c=()=>o(!1);p.useEffect(()=>(document.addEventListener("clickinmodal",c),()=>{document.removeEventListener("clickinmodal",c)}),[]);const a=t=>{u(t.target.name,t.target.type==="checkbox"?t.target.checked:t.target.value)};return s("div",{children:[e("h2",{className:"font-bold text-xl text-center mb-4",children:"Оплата"}),s("form",{onSubmit:y,className:"min-w-[18rem]",children:[s("div",{className:"mb-4 select-none",children:[e(k,{htmlFor:"method",value:"Выберите метод оплаты",color:"text-gray-200",weight:"normal"}),s("div",{className:"relative my-1",onClick:t=>t.stopPropagation(),children:[s("a",{href:"#",onClick:t=>o(i=>!i),className:`flex itenms-center justify-between rounded-lg bg-gray-50 shadow-bb px-2.5 py-2 ${l.method?"text-violet-500":"text-gray-70"}`,children:[e("span",{children:l.method?l.method.title:"Не выбрано"}),e(E,{className:"w-4 h-auto text-gray-700"})]}),x?e("ul",{className:"absolute top-full left-0 w-full rounded-lg bg-gray-50 shadow-bb",children:$.data.map((t,i)=>e("li",{children:e("a",{href:"#",className:"block px-2.5 py-2 text-violet-500 border-t",onClick:N=>{N.preventDefault(),u(I=>({...I,method:t})),o(!1)},children:t.title})},i))}):""]}),e(h,{message:n.method,className:"mt-2"})]}),s("div",{className:"mb-4",children:[e(k,{htmlFor:"sum",value:"Сумма оплаты",color:"text-gray-200",weight:"normal"}),e(P,{id:"sum",type:"number",name:"sum",bg:"bg-gray-50",value:l.sum,className:"mt-1 block w-full text-xl",onChange:a}),e(h,{message:n.sum,className:"mt-2"})]}),s("div",{className:"mb-4",children:["Баланс: ",e("span",{className:"text-blue-400",children:m(r.patient.balance)})]}),s("div",{className:"mb-4",children:[s("label",{htmlFor:"prepay",className:"flex items-center select-none cursor-pointer",children:[e("input",{type:"checkbox",name:"prepay",id:"prepay",onChange:a,defaultChecked:l.prepay,className:"hidden opacity-0 peer"}),e("div",{className:"mr-2 w-5 h-5 peer-checked:hidden border-violet-500 border rounded-[6px]"}),e("div",{className:"mr-2 w-5 h-5 hidden peer-checked:flex items-center justify-center border-violet-500 text-violet-500 border rounded-[6px]",children:e("svg",{className:"w-3 h-3",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M2.5 6L5 8.5L10 3.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e("div",{children:"Предоплата"})]}),e(h,{message:n.prepay,className:"mt-2"})]}),e(S,{className:"w-full mb-4 justify-center text-lg font-semibold",children:"Отправить"}),e("div",{className:"text-center",children:e("a",{href:"#",className:"text-red-500 underline hover:no-underline",onClick:t=>{t.preventDefault(),d(null)},children:"Отменить"})})]})]})},Q=f=>{const{book:r,auth:b}=f,g=`${b.user.role.name}.book.status`,d=L.data.find(a=>a.code==r.status),{setModal:m}=j(),[x,o]=p.useState(!1),{data:l,setData:u,post:w,patch:C,processing:B,errors:n,reset:F,transform:v}=D({status:d});v(a=>({...a,status:a.status.code}));const y=a=>{a&&a.preventDefault(),C(route(g,{book:r.id}),{onSuccess:()=>{m(null)}})},c=()=>o(!1);return p.useEffect(()=>(document.addEventListener("clickinmodal",c),()=>{document.removeEventListener("clickinmodal",c)}),[]),s("div",{children:[e("h2",{className:"font-bold text-xl text-center mb-4",children:"Статус"}),s("form",{onSubmit:y,className:"min-w-[18rem]",children:[s("div",{className:"mb-4",children:[e(k,{htmlFor:"status",value:"Выберите статус",color:"text-gray-200",weight:"font-normal"}),s("div",{className:"relative my-1 select-none",onClick:a=>a.stopPropagation(),children:[s("a",{href:"#",onClick:a=>o(t=>!t),className:`flex itenms-center justify-between rounded-lg bg-gray-50 shadow-bb px-2.5 py-2 ${l.status.color}`,children:[e("span",{children:l.status.title}),e(E,{className:"w-5 h-auto text-gray-700"})]}),x?e("ul",{className:"absolute top-full left-0 w-full rounded-lg bg-gray-50 shadow-bb",children:L.data.map((a,t)=>e("li",{children:e("a",{href:"#",className:`block px-2.5 py-2 ${a.color}`,onClick:i=>{i.preventDefault(),u(N=>({...N,status:a})),o(!1)},children:a.title})},t))}):""]}),e(h,{message:n.status,className:"mt-2"})]}),e(S,{className:"w-full my-4 justify-center text-lg font-semibold",children:"Изменить"}),e("div",{className:"text-center",children:e("a",{href:"#",className:"text-red-500 underline hover:no-underline",onClick:a=>{a.preventDefault(),m(null)},children:"Отменить"})})]})]})};export{Q as B,K as a};
